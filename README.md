-----

# X (Twitter) Archive & Viewer

**X (旧Twitter)** の特定のユーザーの投稿をブラウザから収集し、画像・動画をローカルに一括ダウンロードして、**本家そっくりのUIでオフライン閲覧**できるアーカイブツールです。

 

## 📖 概要

このプロジェクトは3つの主要なコンポーネントで構成されています。

1.  **Scraper (`app-save.js`)**: ブラウザのコンソールで実行し、自動スクロールしながらツイートデータ（テキスト、画像URL、動画URL、投票データ等）を収集します。Reactの内部データ(Fiber)から高画質メディアURLを抽出する機能を備えています。
2.  **Downloader & Merger (`app-jsonparse.py`)**: 収集した生データから画像・動画ファイルをローカルにダウンロードし、過去のデータとマージして保存します。プロフィールの変遷も記録します。
3.  **Viewer (`index.html`)**: ローカルに保存されたJSONデータを読み込み、TwitterライクなUIで閲覧できるWebアプリです。ダークモード、複数アカウント切り替え、メディアのみ表示などの機能があります。

## ✨ 機能

  * **完全オフライン閲覧**: 画像や動画もローカルに保存されるため、ネット環境がなくても閲覧可能。
  * **差分更新**: 新しく取得したツイートのみを既存のデータに追加（マージ）します。
  * **高画質メディア保存**: 元画質（orig）の画像や、最高ビットレートのMP4動画を自動選定してダウンロードします。
  * **リッチなUI**:
      * ライトモード / ダークモード切り替え
      * 「ツイート」と「メディア」のタブ切り替え
      * 投票（Poll）結果の表示再現
      * 複数アカウントのサイドバー管理

## 📂 ファイル構成

```text
.
├── app-save.js          # ブラウザコンソール用スクリプト（データ収集）
├── app-jsonparse.py     # Pythonスクリプト（メディアDL・データ統合）
├── index.html           # ビューワー本体
├── script.js            # ビューワー用ロジック
├── style.css            # ビューワー用スタイルシート
└── [UserID]_tweets_raw.json  # (生成物) スクレイピングした生データ
```

-----

## 🚀 使い方

### Step 1: データの収集 (`app-save.js`)

1.  PCブラウザ（Chrome等）で、アーカイブしたいXのユーザープロフィールページ（`https://x.com/ユーザーID`）を開きます。
      * ※ 検索結果ページ（`from:ユーザーID`）でも動作するように設計されています。
2.  `F12` キーを押して開発者ツールを開き、「Console」タブを選択します。
3.  `app-save.js` の中身をすべてコピーし、コンソールに貼り付けて `Enter` を押します。
4.  **自動スクロール**が始まり、ツイートの収集が開始されます。
      * フォロー数・フォロワー数が自動取得できない場合、プロンプトが表示されるので入力してください。
5.  最下部まで到達するか、読み込みが止まると自動的に `[ユーザーID]_tweets_raw.json` がダウンロードされます。

### Step 2: メディアの保存とデータの統合 (`app-jsonparse.py`)

Python環境が必要です。依存ライブラリとして `requests` を使用します。

```bash
pip install requests
```

1.  Step 1でダウンロードした `*_tweets_raw.json` を、`app-jsonparse.py` と同じフォルダに配置します。
2.  スクリプトを実行します。

<!-- end list -->

```bash
python app-jsonparse.py
```

3.  以下の処理が自動で行われます。
      * 画像・動画のダウンロード（`[ユーザーID]_images/` フォルダが作成されます）。
      * データのマージ（既存の `[ユーザーID]_data.json` があれば更新、なければ新規作成）。
      * プロフィールアイコンや名前の変更履歴の記録。

### Step 3: アーカイブの閲覧 (`index.html`)

1.  `index.html` をブラウザで開きます。
2.  生成された `[ユーザーID]_data.json` ファイルを、画面上のアップロードエリアに**ドラッグ＆ドロップ**します。
      * 初回読み込み時にアカウントがサイドバーに追加されます。
3.  サイドバーからアカウントを選択すると、タイムラインが表示されます。

-----

## ✍️ひとことメモ

他人のツイートを保存する場合は400ツイートくらいで頭打ちになります(API制限により)。全て保存する場合は、検索コマンド(until:yyyy-mm-ddなど)を活用するとよい。

途中で読み込みを止めたい場合は、任意のツイートを詳細表示してください。

-----

## 🛠 技術的な詳細

  * **React Fiber解析**: `app-save.js` はDOMだけでなく、X (Twitter) が使用している React の内部インスタンス（`__reactFiber...`）を解析します。これにより、画面上に表示されていない高解像度の動画URLや詳細なメタデータを取得しています。
  * **JSON構造**: 保存されるデータは、閲覧用UIに最適化しつつ、将来的な拡張性を考慮してメタデータ（`meta`）と投稿データ（`posts`）に分離されています。

## ⚠️ 注意事項

  * **利用規約**: このツールは学習および個人のバックアップ目的で作成されています。X (Twitter) の利用規約を遵守し、過度なリクエストやサーバーへの負荷をかけないよう注意してください。
  * **仕様変更**: XのWebサイトの仕様変更により、`app-save.js` のDOM取得ロジックが機能しなくなる可能性があります。

## 📜 ライセンス

MIT License
